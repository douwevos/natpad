module {

	name 'gross-test';
	
	dependencies {
		module 'natpad.cup';
		module 'gross-dung';
		module 'gobject';
		module 'gross-glibc-runtime';
	}

	loader 'natpad.cup';
	loader 'gross-dung';

	clear {
		remove '[%=module.builddir%]';
	}

	compile {

		gross {
			grammar './test/reduceonempty.cup';
			outputPath './src/reduceonempty/generated';
			prefix 'GroRoe';
		}

		natpadCup {
			grammar './test/reduceonempty.cup';
			jsonconfig './etc/parser-config.json';
			expect 6;
			updateOnly 'false';
		}


		cc { 
			src { path './src/'; } 
			depdir 'deps';
			destdir './compiled/'; 
		
			arg '-O0';
			arg '-ggdb';
			arg '-Wall';
		}


	}

	compile2 {

		gross {
			grammar './test/empty.cup';
			outputPath './src/empty/generated';
			prefix 'GroEmp';
		}

		natpadCup {
			grammar './test/empty.cup';
			jsonconfig './etc/parser-config.json';
			expect 6;
			updateOnly 'false';
		}



		cc { 
			src { path './src/'; } 
			depdir 'deps';
			destdir './compiled/'; 
		
			arg '-O0';
			arg '-ggdb';
			arg '-Wall';
		}


	}


	package {
		clink {
			src './compiled/';
			output './gross-test';
		}
	}	


	export {
		lib {
			file './gross-test';
		}
		headers {
			dir './src/';
		}
	}

}
